{"version":3,"sources":["./src/app/pages/manager/incident-managemment/incident-managemment.page.html","./src/app/pages/manager/incident-managemment/incident-managemment.module.ts","./src/app/pages/manager/incident-managemment/incident-managemment.page.scss","./src/app/pages/manager/incident-managemment/incident-managemment.page.ts"],"names":[],"mappings":"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","file":"pages-manager-incident-managemment-incident-managemment-module-es2015.js","sourcesContent":["module.exports = \"\\r\\n<ion-content class=\\\"container\\\">\\r\\n\\r\\n  <div  class=\\\"content-page\\\">\\r\\n\\r\\n    <div class=\\\"header\\\">\\r\\n      {{ 'PAGES.INCIDENTS_MANAGEMENT.TITLE' | translate }}\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"incident-list\\\">\\r\\n      <africlean-incidents-list\\r\\n              [incidents]=\\\"incidents\\\"\\r\\n              [incidentsTMP]=\\\"incidents\\\"\\r\\n              [nbrIncidentPerPage]=\\\"nbrIncidentsPerPage\\\"\\r\\n              [currentPage]=\\\"currentPage\\\"\\r\\n              (position)=\\\"sendPosition($event)\\\"></africlean-incidents-list>\\r\\n    </div>\\r\\n\\r\\n      <!-- Bouton pour ajouter un nouvel client -->\\r\\n    <ion-fab vertical=\\\"bottom\\\" horizontal=\\\"center\\\" slot=\\\"fixed\\\" (click)=\\\"addIncident()\\\">\\r\\n      <ion-fab-button>\\r\\n        <ion-icon name=\\\"add\\\"></ion-icon>\\r\\n      </ion-fab-button>\\r\\n    </ion-fab>\\r\\n\\r\\n  </div>\\r\\n\\r\\n</ion-content>\\r\\n\"","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { IncidentManagemmentPage } from './incident-managemment.page';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { ComponentsModule } from '../../../components/components.module';\r\nimport {TranslateModule} from '@ngx-translate/core';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: IncidentManagemmentPage\r\n  }\r\n];\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ComponentsModule,\r\n    IonicModule,\r\n    RouterModule.forChild(routes),\r\n    TranslateModule.forChild()\r\n  ],\r\n  declarations: [IncidentManagemmentPage]\r\n})\r\nexport class IncidentManagemmentPageModule {}\r\n","module.exports = \".container .content-page {\\n  margin-top: 14vh;\\n}\\n.container .content-page .header {\\n  font-size: 1.4rem;\\n  margin-bottom: 2rem;\\n  padding-left: 0.5rem;\\n  border-bottom: 1px solid;\\n  border-color: var(--ion-color-grey);\\n  color: var(--ion-color-manage-incidents);\\n}\\n.container .content-page .phone-number {\\n  text-align: center;\\n  margin-bottom: 1rem;\\n}\\n.container .content-page .phone-number span {\\n  color: var(--ion-color-manage-incidents);\\n}\\n.container .content-page .title {\\n  margin-top: 1rem;\\n  margin-bottom: 1rem;\\n  text-decoration: underline;\\n  width: -webkit-max-content;\\n  width: -moz-max-content;\\n  width: max-content;\\n  margin-right: auto;\\n  margin-left: auto;\\n  font-weight: bold;\\n  color: var(--color-grey);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvbWFuYWdlci9pbmNpZGVudC1tYW5hZ2VtbWVudC9DOlxcVXNlcnNcXHRtZGlhbGxvXFxEb2N1bWVudHNcXERvY3VtZW50cyBwZXJzb1xcbWF1cmlDbGVhbi1mcm9udFxcbWF1cmlDbGVhbi1mcm9udC9zcmNcXGFwcFxccGFnZXNcXG1hbmFnZXJcXGluY2lkZW50LW1hbmFnZW1tZW50XFxpbmNpZGVudC1tYW5hZ2VtbWVudC5wYWdlLnNjc3MiLCJzcmMvYXBwL3BhZ2VzL21hbmFnZXIvaW5jaWRlbnQtbWFuYWdlbW1lbnQvaW5jaWRlbnQtbWFuYWdlbW1lbnQucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVFO0VBRUUsZ0JBQUE7QUNGSjtBRElJO0VBQ0UsaUJBQUE7RUFDQSxtQkFBQTtFQUNBLG9CQUFBO0VBQ0Esd0JBQUE7RUFDQSxtQ0FBQTtFQUNBLHdDQUFBO0FDRk47QURLSTtFQUNFLGtCQUFBO0VBQ0EsbUJBQUE7QUNITjtBRElNO0VBQ0Usd0NBQUE7QUNGUjtBRE1JO0VBQ0UsZ0JBQUE7RUFDQSxtQkFBQTtFQUNBLDBCQUFBO0VBQ0EsMEJBQUE7RUFBQSx1QkFBQTtFQUFBLGtCQUFBO0VBQ0Esa0JBQUE7RUFDQSxpQkFBQTtFQUNBLGlCQUFBO0VBQ0Esd0JBQUE7QUNKTiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL21hbmFnZXIvaW5jaWRlbnQtbWFuYWdlbW1lbnQvaW5jaWRlbnQtbWFuYWdlbW1lbnQucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmNvbnRhaW5lcntcclxuXHJcbiAgLmNvbnRlbnQtcGFnZXtcclxuXHJcbiAgICBtYXJnaW4tdG9wOiAxNHZoO1xyXG5cclxuICAgIC5oZWFkZXJ7XHJcbiAgICAgIGZvbnQtc2l6ZTogMS40cmVtO1xyXG4gICAgICBtYXJnaW4tYm90dG9tOiAycmVtO1xyXG4gICAgICBwYWRkaW5nLWxlZnQ6IDAuNXJlbTtcclxuICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkO1xyXG4gICAgICBib3JkZXItY29sb3I6IHZhcigtLWlvbi1jb2xvci1ncmV5KTtcclxuICAgICAgY29sb3I6IHZhcigtLWlvbi1jb2xvci1tYW5hZ2UtaW5jaWRlbnRzKTtcclxuICAgIH1cclxuXHJcbiAgICAucGhvbmUtbnVtYmVye1xyXG4gICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07XHJcbiAgICAgIHNwYW57XHJcbiAgICAgICAgY29sb3I6IHZhcigtLWlvbi1jb2xvci1tYW5hZ2UtaW5jaWRlbnRzKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC50aXRsZSB7XHJcbiAgICAgIG1hcmdpbi10b3A6IDFyZW07XHJcbiAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07XHJcbiAgICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lO1xyXG4gICAgICB3aWR0aDogbWF4LWNvbnRlbnQ7XHJcbiAgICAgIG1hcmdpbi1yaWdodDogYXV0bztcclxuICAgICAgbWFyZ2luLWxlZnQ6IGF1dG87XHJcbiAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gICAgICBjb2xvcjogdmFyKC0tY29sb3ItZ3JleSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsIi5jb250YWluZXIgLmNvbnRlbnQtcGFnZSB7XG4gIG1hcmdpbi10b3A6IDE0dmg7XG59XG4uY29udGFpbmVyIC5jb250ZW50LXBhZ2UgLmhlYWRlciB7XG4gIGZvbnQtc2l6ZTogMS40cmVtO1xuICBtYXJnaW4tYm90dG9tOiAycmVtO1xuICBwYWRkaW5nLWxlZnQ6IDAuNXJlbTtcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkO1xuICBib3JkZXItY29sb3I6IHZhcigtLWlvbi1jb2xvci1ncmV5KTtcbiAgY29sb3I6IHZhcigtLWlvbi1jb2xvci1tYW5hZ2UtaW5jaWRlbnRzKTtcbn1cbi5jb250YWluZXIgLmNvbnRlbnQtcGFnZSAucGhvbmUtbnVtYmVyIHtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBtYXJnaW4tYm90dG9tOiAxcmVtO1xufVxuLmNvbnRhaW5lciAuY29udGVudC1wYWdlIC5waG9uZS1udW1iZXIgc3BhbiB7XG4gIGNvbG9yOiB2YXIoLS1pb24tY29sb3ItbWFuYWdlLWluY2lkZW50cyk7XG59XG4uY29udGFpbmVyIC5jb250ZW50LXBhZ2UgLnRpdGxlIHtcbiAgbWFyZ2luLXRvcDogMXJlbTtcbiAgbWFyZ2luLWJvdHRvbTogMXJlbTtcbiAgdGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmU7XG4gIHdpZHRoOiBtYXgtY29udGVudDtcbiAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xuICBtYXJnaW4tbGVmdDogYXV0bztcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XG4gIGNvbG9yOiB2YXIoLS1jb2xvci1ncmV5KTtcbn0iXX0= */\"","import {Component, EventEmitter, Input, OnInit, Output, ViewChild} from '@angular/core';\r\nimport {AfricleanObservablesProvider} from '../../../../providers/africlean-observables/africlean-observables.provider';\r\nimport {AfricleanModalProvider} from '../../../../providers/africlean-modal/africlean-modal.provider';\r\nimport {ActivatedRoute} from '@angular/router';\r\nimport {AfricleanIncidentComponent} from '../../../components/africlean-incident/africlean-incident.component';\r\nimport {AfricleanHttpIncidentProvider} from '../../../../providers/africlean-http/africlean-http-incident.provider';\r\nimport {AfricleanSessionProvider} from '../../../../providers/africlean-session/africlean-session.provider';\r\nimport {UserRole} from '../../../../providers/utils/commonEnum';\r\n\r\n@Component({\r\n    selector: 'app-incident-managemment',\r\n    templateUrl: './incident-managemment.page.html',\r\n    styleUrls: ['./incident-managemment.page.scss'],\r\n})\r\nexport class IncidentManagemmentPage implements OnInit {\r\n    /**\r\n     * numéro des pages\r\n     */\r\n    public positions = [];\r\n\r\n    /**\r\n     * Position de la page courante\r\n     */\r\n    @Input() public currentPage = 1;\r\n\r\n    /**\r\n     * Subscribes temporaires\r\n     */\r\n    public incidentsTmp: any[];\r\n    public incidents: any[];\r\n\r\n    /**\r\n     * La limite pour récuperer les données\r\n     */\r\n    public limit = 10;\r\n\r\n    /**\r\n     * Données à ignorer\r\n     */\r\n    public skip = 0;\r\n\r\n    /**\r\n     * Le nombre de clients par pages\r\n     */\r\n    @Input() public nbrIncidentsPerPage = 5;\r\n    public role: number;\r\n\r\n    constructor(private observableProvider: AfricleanObservablesProvider,\r\n                private modal: AfricleanModalProvider,\r\n                private session: AfricleanSessionProvider,\r\n                private incidentProvider: AfricleanHttpIncidentProvider,\r\n                private route: ActivatedRoute) {\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.getIncidentsByFilter();\r\n        this.observableProvider.loadClient.subscribe(\r\n            (load) => {\r\n                if (load) {\r\n                    this.limit = 10;\r\n                    this.skip = 0;\r\n                    this.incidents = [];\r\n                    this.incidentsTmp = [];\r\n                    this.positions = [];\r\n                    this.getIncidentsByFilter();\r\n                }\r\n            });\r\n    }\r\n\r\n\r\n    sendPosition(position) {\r\n        this.currentPage = position;\r\n        if (position % 2 === 0 && !this.positions.includes(position)) {\r\n            this.positions.push(position);\r\n            this.skip = this.skip + this.limit;\r\n            this.getIncidentsByFilter();\r\n        }\r\n    }\r\n\r\n    private async getIncidentsByFilter() {\r\n        const user = await this.session.getItem('user');\r\n        const body = {\r\n            limit: this.limit,\r\n            skip: this.skip,\r\n            company: user.entity\r\n        };\r\n        let userId: number;\r\n        let url = 'incident/incidents';\r\n        this.role = await this.session.getItem('role');\r\n        if (this.role === UserRole.CLIENT) {\r\n            userId = await this.session.getItem('userId');\r\n            url = 'incident/user-incident/' + userId;\r\n        } else {\r\n            url = 'incident/incidents';\r\n        }\r\n        this.incidentProvider.save(url, body).subscribe(\r\n            (incidents) => {\r\n                if (!this.incidents && !this.incidentsTmp) {\r\n                    this.incidents = [];\r\n                    this.incidentsTmp = [];\r\n                    this.positions = [];\r\n                }\r\n                console.log(incidents);\r\n                this.incidents = this.incidents.concat(incidents.slice());\r\n                this.incidentsTmp = this.incidentsTmp.concat(this.incidentsTmp.slice());\r\n            }\r\n        );\r\n    }\r\n\r\n\r\n    public addIncident() {\r\n        const props = {\r\n            source: 'consult-incident-management',\r\n            displayForm: true,\r\n            collapseCard: false\r\n        };\r\n        this.modal.create(AfricleanIncidentComponent, 'my-custom-modal-css', props);\r\n    }\r\n}\r\n"],"sourceRoot":""}