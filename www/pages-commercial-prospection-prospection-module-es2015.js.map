{"version":3,"sources":["./src/app/pages/commercial/prospection/prospection.page.html","./src/app/pages/commercial/prospection/prospection.module.ts","./src/app/pages/commercial/prospection/prospection.page.scss","./src/app/pages/commercial/prospection/prospection.page.ts"],"names":[],"mappings":";;;;;;;;;AAAA,4IAA4I,iDAAiD,wJAAwJ,sDAAsD,kvBAAkvB,gEAAgE,iS;;;;;;;;;;;;;;;;;;;;;;;;ACAppC;AACM;AACF;AAEA;AACQ;AACE;AACkB;AACnB;AAEtD,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,iEAAe;KAC3B;CACF,CAAC;AAaF,IAAa,qBAAqB,GAAlC,MAAa,qBAAqB;CAAG;AAAxB,qBAAqB;IAXjC,8DAAQ,CAAC;QACR,OAAO,EAAE;YACP,4DAAY;YACZ,0DAAW;YACX,0DAAW;YACX,8EAAgB;YAChB,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;YAC7B,mEAAe,CAAC,QAAQ,EAAE;SAC3B;QACD,YAAY,EAAE,CAAC,iEAAe,CAAC;KAChC,CAAC;GACW,qBAAqB,CAAG;AAAH;;;;;;;;;;;;AC5BlC,4CAA4C,qBAAqB,GAAG,oCAAoC,sBAAsB,wBAAwB,yBAAyB,6BAA6B,wCAAwC,mBAAmB,GAAG,gIAAgI,sBAAsB,mBAAmB,GAAG,uEAAuE,wCAAwC,GAAG,6CAA6C,+9E;;;;;;;;;;;;;;;;;;;;;ACA9hB;AACqD;AACc;AACF;AACxD;AAOhE,IAAa,eAAe,GAA5B,MAAa,eAAe;IA4CxB,YAAoB,mBAAqD,EACrD,kBAAgD,EAChD,OAAiC;QAFjC,wBAAmB,GAAnB,mBAAmB,CAAkC;QACrD,uBAAkB,GAAlB,kBAAkB,CAA8B;QAChD,YAAO,GAAP,OAAO,CAA0B;QA5C9C,qBAAgB,GAAG,KAAK,CAAC;QAEzB,8BAAyB,GAAG,KAAK,CAAC;QAGzC;;WAEG;QACI,cAAS,GAAG,EAAE,CAAC;QAEtB;;WAEG;QACa,gBAAW,GAAG,CAAC,CAAC;QAYhC;;WAEG;QACI,UAAK,GAAG,EAAE,CAAC;QAElB;;WAEG;QACI,SAAI,GAAG,CAAC,CAAC;QAEhB;;WAEG;QACa,2BAAsB,GAAG,CAAC,CAAC;IAO3C,CAAC;IAED,QAAQ;QACJ,yBAAyB;QACzB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAC7B,CAAC,IAAI,EAAE,EAAE;YACL,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACrB,CAAC,CACJ,CAAC;QACF,IAAI,CAAC,wBAAwB,EAAE,CAAC;QAChC,mFAAmF;QACnF,2BAA2B;QAC3B,IAAI,CAAC,kBAAkB,CAAC,eAAe,CAAC,SAAS,CAC7C,CAAC,IAAI,EAAE,EAAE;YACL,IAAI,IAAI,EAAE;gBACN,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;gBAChB,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;gBACd,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;gBACvB,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;gBAC1B,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;gBACpB,IAAI,CAAC,wBAAwB,EAAE,CAAC;aACnC;QACL,CAAC,CACJ,CAAC;IACN,CAAC;IAGM,iBAAiB,CAAC,KAAU;QAC/B,IAAI,CAAC,gBAAgB,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC;IACjD,CAAC;IAEM,eAAe,CAAC,KAAU;QAC7B,IAAI,CAAC,yBAAyB,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC;IAC1D,CAAC;IAED,YAAY,CAAC,QAAQ;QACjB,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC;QAC5B,IAAI,QAAQ,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE;YAC1D,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC;YACnC,IAAI,CAAC,wBAAwB,EAAE,CAAC;SACnC;IACL,CAAC;IAED;;OAEG;IACU,wBAAwB;;YACjC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YACpD,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;YACtD,IAAI,UAAU,KAAK,oEAAQ,CAAC,UAAU,EAAE;gBACpC,MAAM,GAAG,GAAG,iCAAiC,CAAC;gBAC9C,MAAM,IAAI,GAAG;oBACT,KAAK,EAAE,IAAI,CAAC,KAAK;oBACjB,IAAI,EAAE,IAAI,CAAC,IAAI;oBACf,UAAU,EAAE,MAAM;iBACrB,CAAC;gBACF,IAAI,CAAC,mBAAmB,CAAC,uBAAuB,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC,SAAS,CACjE,CAAC,gBAAgB,EAAE,EAAE;oBACjB,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;wBAC7C,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;wBACvB,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;wBAC1B,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;qBACvB;oBACD,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC,CAAC;oBACvE,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC,CAAC;oBAC7E,IAAI,CAAC,YAAY,GAAG,gBAAgB,CAAC;gBACzC,CAAC,CACJ,CAAC;aACL;iBAAM;gBACH,MAAM,IAAI,GAAG;oBACT,KAAK,EAAE,IAAI,CAAC,KAAK;oBACjB,IAAI,EAAE,IAAI,CAAC,IAAI;iBAClB,CAAC;gBACF,MAAM,GAAG,GAAG,0BAA0B,CAAC;gBACvC,IAAI,CAAC,mBAAmB,CAAC,uBAAuB,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC,SAAS,CACjE,CAAC,gBAAgB,EAAE,EAAE;oBACjB,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;wBAC7C,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;wBACvB,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;wBAC1B,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;qBACvB;oBACD,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC,CAAC;oBACvE,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC,CAAC;oBAC7E,IAAI,CAAC,YAAY,GAAG,gBAAgB,CAAC;gBACzC,CAAC,CACJ,CAAC;aACL;QACL,CAAC;KAAA;CACJ;;YA5F4C,8HAAgC;YACjC,4HAA4B;YACvC,gHAAwB;;AA/B5C;IAAR,2DAAK,EAAE;;oDAAwB;AAyBvB;IAAR,2DAAK,EAAE;;+DAAmC;AAxClC,eAAe;IAL3B,+DAAS,CAAC;QACP,QAAQ,EAAE,iBAAiB;QAC3B,0KAAsC;;KAEzC,CAAC;2EA6C2C,8HAAgC;QACjC,4HAA4B;QACvC,gHAAwB;GA9C5C,eAAe,CAwI3B;AAxI2B","file":"pages-commercial-prospection-prospection-module-es2015.js","sourcesContent":["module.exports = \"\\r\\n<ion-content class=\\\"container\\\">\\r\\n\\r\\n  <div  class=\\\"content-page\\\">\\r\\n\\r\\n    <div class=\\\"header\\\">\\r\\n      {{ 'PAGES.PROSPECT_MANAGEMENT.TITLE' | translate }}\\r\\n    </div>\\r\\n    <div class=\\\"toggle\\\">\\r\\n\\r\\n      <!-- Prospection -->\\r\\n      <ion-item class=\\\"prospection-toggle\\\">\\r\\n        <ion-label>{{ 'PAGES.PROSPECTION.TOGGLE.PROSPECTION' | translate }}</ion-label>\\r\\n        <ion-toggle color=\\\"medium\\\" (ionChange)=\\\"toggleProspection($event)\\\">\\r\\n        </ion-toggle>\\r\\n      </ion-item>\\r\\n      <div class=\\\"prospection\\\" *ngIf=\\\"prospectionCheck\\\">\\r\\n        <app-africlean-prospection\\r\\n                [prospections]=\\\"prospectionsTmp\\\"\\r\\n                [prospectionsTMP]=\\\"prospectionsTmp\\\"\\r\\n                [nbrProspectionPerPage]=\\\"nbrProspectionsPerPage\\\"\\r\\n                [currentPage]=\\\"currentPage\\\"\\r\\n                (position)=\\\"sendPosition($event)\\\"\\r\\n           (loadProspection)=\\\"getProspectionssByFilter()\\\"></app-africlean-prospection>\\r\\n      </div>\\r\\n\\r\\n      <!-- Dashboard de propection -->\\r\\n      <ion-item class=\\\"dashboard-toggle\\\">\\r\\n        <ion-label>{{ 'PAGES.PROSPECTION.TOGGLE.DASHBOARD_PROSPECTION' | translate }}</ion-label>\\r\\n        <ion-toggle color=\\\"medium\\\" (ionChange)=\\\"toggleDashboard($event)\\\">\\r\\n        </ion-toggle>\\r\\n      </ion-item>\\r\\n      <div class=\\\"prospection\\\" *ngIf=\\\"dashboardProspectionCheck\\\">\\r\\n\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n  </div>\\r\\n\\r\\n</ion-content>\\r\\n\"","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { ProspectionPage } from './prospection.page';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { ComponentsModule } from '../../../components/components.module';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: ProspectionPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    ComponentsModule,\r\n    RouterModule.forChild(routes),\r\n    TranslateModule.forChild()\r\n  ],\r\n  declarations: [ProspectionPage]\r\n})\r\nexport class ProspectionPageModule {}\r\n","module.exports = \".container .content-page {\\n  margin-top: 14vh;\\n}\\n.container .content-page .header {\\n  font-size: 1.4rem;\\n  margin-bottom: 2rem;\\n  padding-left: 0.5rem;\\n  border-bottom: 1px solid;\\n  border-color: var(--ion-color-grey);\\n  color: #1eb70c;\\n}\\n.container .content-page .toggle .prospection-toggle ion-label, .container .content-page .toggle .dashboard-toggle ion-label {\\n  font-weight: bold;\\n  color: #1eb70c;\\n}\\n.container .content-page .toggle .prospection ion-item ion-label h2 {\\n  color: var(--ion-color-prospection);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcGFnZXMvY29tbWVyY2lhbC9wcm9zcGVjdGlvbi9DOlxcVXNlcnNcXHRtZGlhbGxvXFxEb2N1bWVudHNcXERvY3VtZW50cyBwZXJzb1xcbWF1cmlDbGVhbi1mcm9udFxcbWF1cmlDbGVhbi1mcm9udC9zcmNcXGFwcFxccGFnZXNcXGNvbW1lcmNpYWxcXHByb3NwZWN0aW9uXFxwcm9zcGVjdGlvbi5wYWdlLnNjc3MiLCJzcmMvYXBwL3BhZ2VzL2NvbW1lcmNpYWwvcHJvc3BlY3Rpb24vcHJvc3BlY3Rpb24ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVFO0VBRUUsZ0JBQUE7QUNGSjtBRElJO0VBQ0UsaUJBQUE7RUFDQSxtQkFBQTtFQUNBLG9CQUFBO0VBQ0Esd0JBQUE7RUFDQSxtQ0FBQTtFQUVBLGNBQUE7QUNITjtBRFVRO0VBRUUsaUJBQUE7RUFDQSxjQUFBO0FDVFY7QURpQlk7RUFDRSxtQ0FBQTtBQ2ZkIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvY29tbWVyY2lhbC9wcm9zcGVjdGlvbi9wcm9zcGVjdGlvbi5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVye1xyXG5cclxuICAuY29udGVudC1wYWdle1xyXG5cclxuICAgIG1hcmdpbi10b3A6IDE0dmg7XHJcblxyXG4gICAgLmhlYWRlcntcclxuICAgICAgZm9udC1zaXplOiAxLjRyZW07XHJcbiAgICAgIG1hcmdpbi1ib3R0b206IDJyZW07XHJcbiAgICAgIHBhZGRpbmctbGVmdDogMC41cmVtO1xyXG4gICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQ7XHJcbiAgICAgIGJvcmRlci1jb2xvcjogdmFyKC0taW9uLWNvbG9yLWdyZXkpO1xyXG4gICAgIC8vIGNvbG9yOiB2YXIoLS1pb24tY29sb3ItcHJvc3BlY3Rpb24pO1xyXG4gICAgICBjb2xvcjogIzFlYjcwYztcclxuICAgIH1cclxuXHJcbiAgICAudG9nZ2xle1xyXG5cclxuICAgICAgLnByb3NwZWN0aW9uLXRvZ2dsZSwgLmRhc2hib2FyZC10b2dnbGUge1xyXG5cclxuICAgICAgICBpb24tbGFiZWx7XHJcbiAgICAgICAgLy8gIGNvbG9yOiB2YXIoLS1pb24tY29sb3ItcHJvc3BlY3Rpb24pO1xyXG4gICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgICAgICAgICBjb2xvcjogIzFlYjcwYztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC5wcm9zcGVjdGlvbiB7XHJcbiAgICAgICAgaW9uLWl0ZW17XHJcblxyXG4gICAgICAgICAgaW9uLWxhYmVse1xyXG4gICAgICAgICAgICBoMntcclxuICAgICAgICAgICAgICBjb2xvcjogdmFyKC0taW9uLWNvbG9yLXByb3NwZWN0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgfVxyXG59XHJcbiIsIi5jb250YWluZXIgLmNvbnRlbnQtcGFnZSB7XG4gIG1hcmdpbi10b3A6IDE0dmg7XG59XG4uY29udGFpbmVyIC5jb250ZW50LXBhZ2UgLmhlYWRlciB7XG4gIGZvbnQtc2l6ZTogMS40cmVtO1xuICBtYXJnaW4tYm90dG9tOiAycmVtO1xuICBwYWRkaW5nLWxlZnQ6IDAuNXJlbTtcbiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkO1xuICBib3JkZXItY29sb3I6IHZhcigtLWlvbi1jb2xvci1ncmV5KTtcbiAgY29sb3I6ICMxZWI3MGM7XG59XG4uY29udGFpbmVyIC5jb250ZW50LXBhZ2UgLnRvZ2dsZSAucHJvc3BlY3Rpb24tdG9nZ2xlIGlvbi1sYWJlbCwgLmNvbnRhaW5lciAuY29udGVudC1wYWdlIC50b2dnbGUgLmRhc2hib2FyZC10b2dnbGUgaW9uLWxhYmVsIHtcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XG4gIGNvbG9yOiAjMWViNzBjO1xufVxuLmNvbnRhaW5lciAuY29udGVudC1wYWdlIC50b2dnbGUgLnByb3NwZWN0aW9uIGlvbi1pdGVtIGlvbi1sYWJlbCBoMiB7XG4gIGNvbG9yOiB2YXIoLS1pb24tY29sb3ItcHJvc3BlY3Rpb24pO1xufSJdfQ== */\"","import {Component, Input, OnInit} from '@angular/core';\r\nimport {AfricleanSessionProvider} from '../../../../providers/africlean-session/africlean-session.provider';\r\nimport {AfricleanHttpProspectionProvider} from '../../../../providers/africlean-http/africlean-http-prospection.provider';\r\nimport {AfricleanObservablesProvider} from '../../../../providers/africlean-observables/africlean-observables.provider';\r\nimport {UserRole} from \"../../../../providers/utils/commonEnum\";\r\n\r\n@Component({\r\n    selector: 'app-prospection',\r\n    templateUrl: './prospection.page.html',\r\n    styleUrls: ['./prospection.page.scss'],\r\n})\r\nexport class ProspectionPage implements OnInit {\r\n\r\n    public prospectionCheck = false;\r\n\r\n    public dashboardProspectionCheck = false;\r\n\r\n\r\n    /**\r\n     * numéro des pages\r\n     */\r\n    public positions = [];\r\n\r\n    /**\r\n     * Position de la page courante\r\n     */\r\n    @Input() public currentPage = 1;\r\n\r\n    /**\r\n     * Prosctions temporaires\r\n     */\r\n    public prospectionsTmp: any[];\r\n\r\n    /**\r\n     * Prosctions\r\n     */\r\n    public prospections: any[];\r\n\r\n    /**\r\n     * La limite pour récuperer les données\r\n     */\r\n    public limit = 14;\r\n\r\n    /**\r\n     * Données à ignorer\r\n     */\r\n    public skip = 0;\r\n\r\n    /**\r\n     * Le nombre de clients par pages\r\n     */\r\n    @Input() public nbrProspectionsPerPage = 7;\r\n\r\n    public role: number;\r\n\r\n    constructor(private prospectionProvider: AfricleanHttpProspectionProvider,\r\n                private observableProvider: AfricleanObservablesProvider,\r\n                private session: AfricleanSessionProvider) {\r\n    }\r\n\r\n    ngOnInit() {\r\n        // Initialisation du role\r\n        this.session.getItem('role').then(\r\n            (role) => {\r\n                this.role = role;\r\n            }\r\n        );\r\n        this.getProspectionssByFilter();\r\n        // Dés qu'il y'a un chamgement au niveau des prospections notament une mise a jour,\r\n        // on récharge les données.\r\n        this.observableProvider.loadProspection.subscribe(\r\n            (load) => {\r\n                if (load) {\r\n                    this.limit = 14;\r\n                    this.skip = 0;\r\n                    this.prospections = [];\r\n                    this.prospectionsTmp = [];\r\n                    this.positions = [];\r\n                    this.getProspectionssByFilter();\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n\r\n    public toggleProspection(event: any) {\r\n        this.prospectionCheck = event.detail.checked;\r\n    }\r\n\r\n    public toggleDashboard(event: any) {\r\n        this.dashboardProspectionCheck = event.detail.checked;\r\n    }\r\n\r\n    sendPosition(position) {\r\n        this.currentPage = position;\r\n        if (position % 7 === 0 && !this.positions.includes(position)) {\r\n            this.positions.push(position);\r\n            this.skip = this.skip + this.limit;\r\n            this.getProspectionssByFilter();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Retourne tous les prospections\r\n     */\r\n    public async getProspectionssByFilter() {\r\n        const userId = await this.session.getItem('userId');\r\n        const roleAuthor = await this.session.getItem('role');\r\n        if (roleAuthor === UserRole.COMMERCIAL) {\r\n            const url = 'prospection/commercial-prospect';\r\n            const body = {\r\n                limit: this.limit,\r\n                skip: this.skip,\r\n                authorCode: userId,\r\n            };\r\n            this.prospectionProvider.getProspectByUserAuthor(url, body).subscribe(\r\n                (prospectionsList) => {\r\n                    if (!this.prospections && !this.prospectionsTmp) {\r\n                        this.prospections = [];\r\n                        this.prospectionsTmp = [];\r\n                        this.positions = [];\r\n                    }\r\n                    this.prospections = this.prospections.concat(prospectionsList.slice());\r\n                    this.prospectionsTmp = this.prospectionsTmp.concat(prospectionsList.slice());\r\n                    this.prospections = prospectionsList;\r\n                }\r\n            );\r\n        } else {\r\n            const body = {\r\n                limit: this.limit,\r\n                skip: this.skip,\r\n            };\r\n            const url = 'prospection/prospections';\r\n            this.prospectionProvider.getProspectByUserAuthor(url, body).subscribe(\r\n                (prospectionsList) => {\r\n                    if (!this.prospections && !this.prospectionsTmp) {\r\n                        this.prospections = [];\r\n                        this.prospectionsTmp = [];\r\n                        this.positions = [];\r\n                    }\r\n                    this.prospections = this.prospections.concat(prospectionsList.slice());\r\n                    this.prospectionsTmp = this.prospectionsTmp.concat(prospectionsList.slice());\r\n                    this.prospections = prospectionsList;\r\n                }\r\n            );\r\n        }\r\n    }\r\n}\r\n"],"sourceRoot":""}